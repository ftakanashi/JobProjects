## List的动态扩容机制

相比于传统数组，Python中的列表好用就好用在于，1.他可以装任意类型的数据， 2.他不用在声明时声明固定长度并且使用时不能超过。

第一点，因为Python中所有东西都是对象，所以列表只需要维护对象的指针，就可以做到装任意东西（事实上列表是一个指针的数组）。
第二点，则是因为Python的List的动态扩容机制了。动态扩容机制十分简单易懂，在标准CPython实现中是这样的：

空列表时，只申请保留一些列表meta信息的空间，大概在50-60字节。之后持续的append元素进来。
当长度到达4时，第5个进来前，扩容一倍，长度变成8。又来4个后，再扩容一倍，长度变成16。
之后第17个元素进来前，16扩容9个单位，变成25。之后每次扩容，扩容步长+1，所以整个需要扩容的长度形成的一个序列是：`0 4 8 16 25 35 46 58...`。

更具体的，上面==每一个单位，其实是一个指针的长度，64位系统的话就是8个字节==。所以，运行下面这段程序可以得到所示输出：

```python
import sys
lst = []
for _ in range(27):
	print(f'length = {len(lst)}, size = {sys.getsizeof(lst)}')
  lst.append(None)
  
'''
length = 0, size = 56
length = 1, size = 88
（略）
length = 4, size = 88
length = 5, size = 120
（略）
length = 8, size = 120
length = 9, size = 184
（略）
length = 16, size = 184
length = 17, size = 256
（略）
length = 25, size = 256
length = 26, size = 336
'''
```

另外，==所谓的“大小从m扩容n”的过程，其实是指在内存中申请一个全新的n大小的空间，然后将原空间中的m个元素复制到这片空间的前m个位置==。非常单纯的做法。