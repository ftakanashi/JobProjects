# LeetBook 操作系统指南

## 入门

### 运行状态
![](https://pic.leetcode-cn.com/1612664723-uBmzJL-os1-2.png)

计算机运行有两种模式，用户态和内核态。
只有处于内核态的程序才有资格进行一些操作比如对硬件的调用等。

操作系统也是软件，位于内核态。

用户接口程序指shell之类的，虽然不用管如何调用硬件实现，但是可以做到一些程序功能的简单程序。
这部分程序更加靠近底层。

### 硬件
####CPU
![](https://pic.leetcode-cn.com/1612664727-CWPgcZ-os1-3.png)

CPU、内存、I/O 设备都和总线串联起来并通过总线与其他设备进行通信

CPU 是计算机的大脑，它主要和内存进行交互。
一个 CPU 的执行周期是从内存中提取第一条指令、解码并决定它的类型和操作数，执行，然后再提取、解码执行后续的指令。

每个 CPU 都有一组可以执行的特定指令集。因此不同架构的CPU之间无法混用程序。

由于从内存中读取指令和数据通常比操作指令本身更加耗时，因此CPU通常还会带有寄存器结构。
用于和内存进行批量的计算结果交流。

为了提升性能， CPU 设计人员早就放弃了同时去读取、解码和执行一条简单的指令。许多现代的 CPU 都具有同时读取多条指令的机制。
例如，一个 CPU 可能会有单独访问、解码和执行单元，所以，当 CPU 执行第 N 条指令时，还可以对 N + 1 条指令解码，还可以读取 N + 2 条指令。
像这样的组织形式被称为 流水线(pipeline)。

为了获取操作系统的服务，用户程序必须使用 系统调用(system call)，系统调用会转换为内核态并且调用操作系统。
TRAP 指令用于把用户态切换为内核态并启用操作系统。

#### 内存
广义的内存泛指存储器。
存储器的访问速度和可以承载的大小是一对trade-off的量。根据不同情况需要的存储器性能不同，通常将其分为：
寄存器，高速缓存，主存，磁盘。
狭义的内存指第三项，主存。这一块访问时间在10ns，容量可以做到几GB。

主存也叫RAM (Random Access Memory)。断电后其中内容会丢失。

断电后不丢失的主存称为ROM (Read Only Memory)，为了保证断点后内容不丢失，代价是一旦内容写入就不能再更改。
所以光盘和游戏卡带之类的也叫ROM。

当然也没有那么严格，还有一部分存储器具有"可写入性"的ROM的特点。
比如闪存（U盘）之类的。通常写入会比较花时间，但是本质上他是一个可写的ROM。

固态硬盘某种意义上也是闪存。随着技术进步闪存的容量可以做大，磨损可以减轻，因此就出现了SSD。


